<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>public</title>
    <!-- ICONSOUT CDN -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css"> <!-- LINK CSS -->
    <link rel="stylesheet" href="/stylesheets/profile.css">
    </link>


</head>

<body>
    <div class="alluser">
        <% alluser.forEach(function(user){ %>
            <a href="/userPage/<%= user.id %>">
                <div class="user">
                    <div class="profile-photo">
                        <img src="/images/uploads/<%= user.profileimage %>" alt="">
                    </div>
                    <div class="name">
                        <h1>
                            <%= user.first_name %>
                                <%= user.last_name %>
                        </h1>
                    </div>
                    <i class="ri-close-fill"></i>
                </div>
            </a>
            <% }) %>
    </div>




    <div class="profile-nav">
        <div class="nav-prt1">
            <h1>Facebook</h1>
        </div>
        <div class="nav-prt2">
            <i class="uil uil-search"></i>
            <input id="message-search-alluser" type="search"
                placeholder="Search for creators, inspirations, and projects">
        </div>
        <div class="nav-prt3">
            <a href="/public">Home</a>
            <a href="/logout">Log out</a>
        </div>
    </div>
    <div class="profile-main">
        <div class="profile-main-top">
            <div class="profile-main-top-prt1">
                <div class="cover-photo">
                    <img src="/images/uploads/<%= user.cover_photo %>">
                </div>
            </div>
            <div class="profile-main-top-prt2">
                <div class="left">
                    <div class="profile-pic">
                        <img src="/images/uploads/<%= user.profileimage %>" alt="">
                    </div>
                    <div class="name-section">
                        <h1>
                            <%= user.first_name %>
                                <%= user.last_name %>
                        </h1>
                        <h4>
                            <%= user.friends.friend.length %>
                                <%= user.friends.friend.length> 1 ? "friends" : "friend" %>
                        </h4>
                        <div class="freinds-pics">
                            <% friends.forEach(function(user){ %>
                                <div class="friend-pic">
                                    <img src="/images/uploads/<%= user.profileimage %>" alt="">
                                </div>
                                <% }) %>
                        </div>
                    </div>
                </div>
                <div class="right">
                    <% if(user.friends.friend_requests.indexOf(loggedInuser.id) !=-1){ %>

                        <button style="background: rgb(255, 145, 0); color: white;"><i style="margin-right: 10px;"
                                class="ri-check-double-line"></i>freind
                            Request
                            sent</button>
                        <% }else{ %>
                            <% if(loggedInuser.friends.friend.indexOf(user.id) !=-1){ %>
                                <button style="background:rgb(69, 235, 60); color: black;"><i
                                        class="ri-user-follow-line"></i>
                                    freinds</button>
                                <% }else{%>
                                    <a id="sent-request" href="/friends-request/<%= user.id%>"
                                        data-post-id="<%= user.id %>"><button
                                            style="background: #6B4DE6; color: white;">Add freind</button></a>
                                    <% } %>
                                        <% } %>
                                            <a href="/unfriends/<%= user.id%>"><button id="remove-freind">Remove
                                                    Freind</button></a>

                </div>
            </div>
            <div class="profile-main-top-prt3">
                <h4 class="active">Posts</h4>
                <h4>About</h4>
                <h4>Freinds</h4>
                <h4>Photos</h4>
                <h4>Videos</h4>
                <h4>Cheks-in</h4>
            </div>
        </div>
        <div class="profile-main-bottom">
            <div class="left">
                <div class="intro">

                    <h1>Intro</h1>
                    <% if(user.newBio.length>0){ %>
                        <p>We are the once who don't stand behind anyone , the lines starts from where we stand ðŸ˜ŽðŸ˜ŽðŸ¤˜
                        </p>
                        <h5><i class="ri-graduation-cap-fill"></i>Studied at <b> NRI Institute of Science and
                                Technology</b>
                        </h5>
                        <h5><i class="ri-graduation-cap-fill"></i>Went to Govt. boys high secondary school biaora
                            rajgarh
                        </h5>
                        <h5><i class="ri-home-4-fill"></i>Lives in <b> Bhopal, Madhya Pradesh</b></h5>
                        <h5><i class="ri-map-pin-fill"></i>From <b> Biaora</b></h5>
                        <% }else{ %>
                            <p><b>
                                    <%= user.first_name %>
                                </b> have no bio yet</p>
                            <% } %>

                </div>
                <div class="freinds">
                    <div class="nav">
                        <div class="head">
                            <h1>freinds</h1>
                            <p>
                                <%= user.friends.friend.length %>
                                    <%= user.friends.friend.length> 1 ? "friends" : "friend" %>
                            </p>
                        </div>
                        <a>See all freinds</a>
                    </div>
                    <div class="photos-main">
                        <% if(friends.length> 0){ %>

                            <% friends.forEach(function(user){ %>
                                <div class="photos">
                                    <div class="photo">
                                        <div class="overlay"></div>
                                        <img src="/images/uploads/<%= user.profileimage %>" alt="">
                                    </div>
                                    <p>
                                        <%= user.first_name %>
                                            <%= user.last_name %>
                                    </p>
                                </div>
                                <% }) %>
                                    <% }else{ %>
                                        <p><b>
                                                <%= user.first_name %>
                                            </b> have no friends yet</p>
                                        <% } %>


                    </div>
                </div>
            </div>
            <div class="right">
                <div style="margin-top: -15px;" class="feeds">
                    <% user.posts.forEach(function(post){ %>
                        <div class="feed">
                            <div class="head">
                                <div class="user">
                                    <div class="profile-photo">
                                        <a href="/userPage/<%= user._id %>">
                                            <img src="/images/uploads/<%= user.profileimage %>">
                                        </a>
                                    </div>
                                    <div class="info">
                                        <h3>
                                            <%= user.first_name %>
                                                <%= user.last_name %>
                                        </h3>
                                        <small>
                                            <%= post.date.toLocaleDateString('en-US', { year: 'numeric' , month: 'short'
                                                , day: 'numeric' }) %>
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div class="photo">
                                <img src="/images/uploads/<%= post.post %>">
                            </div>
                            <div class="action-button">
                                <div class="interaction-buttons">
                                    <% if(post.likes.includes(loggedInuser._id)){ %>
                                        <a class="like-button" data-post-id="<%= post._id %>">
                                            <h1 style="color: red;"><i class="ri-heart-fill"></i></h1>
                                        </a>
                                        <% }else{ %>
                                            <a class="like-button" data-post-id="<%= post._id %>">
                                                <h1><i class="ri-heart-line"></i></h1>
                                            </a>
                                            <% } %>
                                                <span id="comment-icon" data-post-id="<%= post._id %>"><i
                                                        class="uil uil-comment-dots"></i></span>
                                                <span><i class="uil uil-share-alt"></i></span>
                                </div>
                                <div class="bookmark">
                                    <% if(loggedInuser.bookmark.includes(post._id)){ %>
                                        <a class="bookmark-button" href="/bookmarkPost/<%= post._id %>"
                                            data-post-id="<%= post._id %>">
                                            <span><i class="ri-bookmark-fill"></i></span>
                                        </a>
                                        <% } else { %>
                                            <a class="bookmark-button" href="/bookmarkPost/<%= post._id %>"
                                                data-post-id="<%= post._id %>">
                                                <span><i class="ri-bookmark-line"></i></span>
                                            </a>
                                            <% } %>
                                </div>
                            </div>
                            <div class="liked-by">
                                <p class="like-count2">Liked by
                                    <b>
                                        <%= post.likes.length %> others
                                    </b>
                                </p>
                            </div>
                            <div class="caption">
                                <p><b>
                                        <%= user.first_name %>
                                    </b>
                                    <%= user.description%> <span class="harsh-tag">#lifestyle</span>
                                </p>
                            </div>
                            <div class="comment-form" id="comment-form-<%= post._id %>">
                                <form id="comment-form" method="post" data-post-id="<%= post._id %>"
                                    action="/comment/<%= post._id %>">
                                    <input id="comment-input" type="text" name="comment" placeholder="write comment...."
                                        autocomplete="off">
                                    <input type="submit" value="Comment">
                                </form>
                            </div>
                            <div class="comments comment-count-<%= post._id %>">
                                <a>View all <%= post.comment.length %> comments</a>
                            </div>
                            <div id="comments-main" class="comment-section-<%= post._id %>">
                                <% post.comment.reverse().forEach(function(comment) { %>
                                    <div class="comment">
                                        <div class="comment-left">
                                            <div class="comment-proPic">
                                                <img src="/images/uploads/<%= comment.userpic %>" alt="">
                                            </div>
                                        </div>
                                        <div class="comment-right">
                                            <div>
                                                <h5><b>
                                                        <%= comment.user %>
                                                    </b></h5>
                                                <p>
                                                    <%= comment.text %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>
                        <% }) %>


                </div>
            </div>
        </div>
    </div>


    <script src="/javascripts/script.js"></script>
    <script src="/javascripts/profile.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.2/axios.min.js"
        integrity="sha512-NCiXRSV460cHD9ClGDrTbTaw0muWUBf/zB/yLzJavRsPNUl9ODkUVmUHsZtKu17XknhsGlmyVoJxLg/ZQQEeGA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</body>

</html>